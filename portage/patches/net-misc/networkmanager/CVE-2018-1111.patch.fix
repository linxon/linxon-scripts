From 16546798c589bd0a06a04460fde5628925c7fba0 Mon Sep 17 00:00:00 2001
From: Pavel Zhukov <pzhukov@redhat.com>
Date: Tue, 15 May 2018 09:35:58 +0200
Subject: Fix for CVE-2018-1111

---
 11-dhclient | 2 +-
 dhcp.spec   | 5 ++++-
 2 files changed, 5 insertions(+), 2 deletions(-)

diff --git a/11-dhclient b/11-dhclient
index 3be4cd6..4bf9384 100644
--- a/11-dhclient
+++ b/11-dhclient
@@ -7,7 +7,7 @@ ETCDIR=/etc/dhcp
 interface=$1
 
 eval "$(
-declare | LC_ALL=C grep '^DHCP4_[A-Z_]*=' | while read opt; do
+declare | LC_ALL=C grep '^DHCP4_[A-Z_]*=' | while read -r opt; do
     optname=${opt%%=*}
     optname=${optname,,}
     optname=new_${optname#dhcp4_}
diff --git a/dhcp.spec b/dhcp.spec
index 3f41835..7574f57 100644
--- a/dhcp.spec
+++ b/dhcp.spec
@@ -16,7 +16,7 @@
 Summary:  Dynamic host configuration protocol software
 Name:     dhcp
 Version:  4.3.6
-Release:  20%{?dist}
+Release:  21%{?dist}
 # NEVER CHANGE THE EPOCH on this package.  The previous maintainer (prior to
 # dcantrell maintaining the package) made incorrect use of the epoch and
 # that's why it is at 12 now.  It should have never been used, but it was.
@@ -677,6 +677,9 @@ done
 %endif
 
 %changelog
+* Tue May 15 2018 Pavel Zhukov <pzhukov@redhat.com> - 12:4.3.6-21
+- Fix for CVE-2018-1111
+
 * Fri Apr  6 2018 Pavel Zhukov <pzhukov@redhat.com> - 12:4.3.6-20
 - Discover hwaddr for all interfaces for xid uniqueness
 
-- 
cgit v1.1

